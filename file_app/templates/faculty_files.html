{% extends "base.html" %}
{% load static %}
{% block content %}
<!-- Begin Page Content -->
<script src="https://cdn.asprise.com/scannerjs/scanner.js" type="text/javascript"></script>
    <script>
        //
        // Please read scanner.js developer's guide at: http://asprise.com/document-scan-upload-image-browser/ie-chrome-firefox-scanner-docs.html
        //

        /** Initiates a scan */
        function scanToJpg() {
            scanner.scan(displayImagesOnPage,
                    {
                        "output_settings": [
                            {
                                "type": "return-base64",
                                "format": "jpg"
                            }
                        ]
                    }
            );
        }

        /** Processes the scan result */
        function displayImagesOnPage(successful, mesg, response) {
            if(!successful) { // On error
                console.error('Failed: ' + mesg);
                return;
            }

            if(successful && mesg != null && mesg.toLowerCase().indexOf('user cancel') >= 0) { // User cancelled.
                console.info('User cancelled');
                return;
            }

            var scannedImages = scanner.getScannedImages(response, true, false); // returns an array of ScannedImage
            for(var i = 0; (scannedImages instanceof Array) && i < scannedImages.length; i++) {
                var scannedImage = scannedImages[i];
                processScannedImage(scannedImage);
            }
        }

        /** Images scanned so far. */
        var imagesScanned = [];

        /** Processes a ScannedImage */
        function processScannedImage(scannedImage) {
            imagesScanned.push(scannedImage);
            var elementImg = scanner.createDomElementFromModel( {
                'name': 'img',
                'attributes': {
                    'class': 'scanned',
                    'src': scannedImage.src
                }
            });
            document.getElementById('images').appendChild(elementImg);
        }

    </script>
    <style>
        img.scanned {
            height: 200px; /** Sets the display size */
            margin-right: 12px;
        }

        div#images {
            margin-top: 20px;
        }
    </style>
</head>
        <div class="container-fluid">
        <!-- Page Heading -->
        <h1 class="h3 mb-2 text-gray-800">{{ faculty }}'s Files</h1><hr>
        <!-- Back Button -->
        <div style="position: relative;">
            <a href="{% url 'faculty_list' %}" class="btn btn-dark" style="position: center; top: 30px; right: 20px;">
                <i class="fas fa-arrow-left"></i> Back
            </a>
        </div>
        <div>
            <div id="images">
            <div class="row" id="uploadedFilesList">
                    <div class="col-md-3 mb-3">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">{{ file.file_name }}</h5>
                                <a href="#" class="file-preview-link" data-src="{{ file.file_path.url }}">
                                    <img src="{{ file.file_path.url }}" class="img-fluid" alt="{{ file.file_name }}">
                                </a>
                            </div>
                        </div>
                    </div>
            </div>
            </div>
        </div>
    </div>
    <div id="images">
    <!-- Scan Button -->
    <div style="position: fixed; bottom: 100px; right: 20px;">
        <button id="scanButton" class="btn btn-dark btn-circle btn-lg" onclick="scanToJpg();">
            <i class="fas fa-qrcode"></i>
    </div>
</div>
<!-- Back Button -->

</div>

{% endblock content %}
